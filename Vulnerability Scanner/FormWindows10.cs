using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Microsoft.GroupPolicy;

namespace Vulnerability_Scanner
{
    public partial class FormWindows10 : Form
    {
        public FormWindows10()
        {
            InitializeComponent();
        }

        private void ButtonHome_Click(object sender, EventArgs e)
        {
            FormMenu formMenu = new FormMenu();
            formMenu.Show();
            this.Hide();
        }

        private void ButtonWindowScan_Click(object sender, EventArgs e)
        {
            /*
            
            string text = File.ReadAllText(@"C:\Windows\System32\GroupPolicy\Machine\Registry.pol");
            
            string readContents = "";
            using (StreamReader streamReader = new StreamReader(@"C:\Windows\System32\GroupPolicy\Machine\Registry.pol", Encoding.ASCII))
            {
                while(streamReader.Peek() >= 0)
                {
                    readContents += streamReader.ReadLine();
                }
                
            }

            System.Diagnostics.Debug.WriteLine("Contents of Group Policy File = " + readContents);

            string path = @"C:\Windows\System32\GroupPolicy\Machine\Registry.pol";

            byte[] test = { };

            if (File.Exists(path))
            {
                test = File.ReadAllBytes(path);
            }

            string strtest = System.Text.Encoding.UTF32.GetString(test);

            System.Diagnostics.Debug.WriteLine(strtest.Length);
            System.Diagnostics.Debug.WriteLine(strtest);
            //System.Diagnostics.Debug.WriteLine(BitConverter.ToString(test));

            */

            //Bens code:
            //GPDomain thisDomain = new GPDomain();
            //GpoCollection gpCol = thisDomain.GetAllGpos();

            //System.Diagnostics.Debug.WriteLine(gpCol.ToString());

            GPDomain domain = new GPDomain();
            GpoCollection gpos = domain.GetAllGpos();

            //System.Diagnostics.Debug.WriteLine(gpos);

        }


        private void ButtonHome_MouseEnter(object sender, EventArgs e)
        {
            btnHome.BackColor = Color.Turquoise;
        }

        private void ButtonHome_MouseLeave(object sender, EventArgs e)
        {
            btnHome.BackColor = Color.SlateBlue;
        }

        private void ButtonStartScan_MouseEnter(object sender, EventArgs e)
        {
            btnStartScan.BackColor = Color.Turquoise;
        }

        private void ButtonStartScan_MouseLeave(object sender, EventArgs e)
        {
            btnStartScan.BackColor = Color.SlateBlue;
        }
    }
}