using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Diagnostics;
using System.Threading;

namespace Vulnerability_Scanner
{
    public partial class FormWindow10 : Form
    {

        public FormWindow10()
        {
            InitializeComponent();
            CreateListDescription();
        }

        private void CreateListDescription()
        {
            Point lblLocation = new Point(0, 0);
            Point chkbxLocation = new Point(450, 0);

            List<string> listText = new List<string>();

            listText.Add("1. Computer Configuration > Administrative Templates > \r\nNetwork > Network Connections > \r\nRequire domain users to elevate when setting a network’s location");
            listText.Add("2. Computer Configuration > Administrative Templates > \r\nWindows Components > Credential User Interface > \r\nDo not display the password reveal button");
            listText.Add("3. Computer Configuration > Administrative Templates > \r\nWindows Components > OneDrive > \r\nPrevent the usage of OneDrive for file storage");
            listText.Add("4. Computer Configuration > Administrative Templates > \r\nWindows Components > Sync your settings > Do not sync");
            listText.Add("5. Computer Configuration > Administrative Templates > \r\nWindows Components > Search > Allow Cortana");
            listText.Add("6. Computer Configuration > Administrative Templates > \r\nWindows Components > Search > \r\nDon’t search the web or display web results in Search");
            listText.Add("7. Computer Configuration > Administrative Templates > \r\nWindows Components > Store > Disable all apps from Microsoft Store");
            listText.Add("8. Computer Configuration > Administrative Templates > \r\nWindows Components > Store > \r\nTurn off Automatic Download and Install of updates");
            listText.Add("9. Computer Configuration > Administrative Templates > \r\nWindows Components > Store > Turn off the Store application");
            listText.Add("10. User Configuration > Administrative Templates > \r\nControl Panel > Personalization > Screen saver timeout");
            listText.Add("11. Computer Configuration > Administrative Templates > \r\nSystem > Logon > Turn off picture password sign-in");
            listText.Add("12. Computer Configuration > Administrative Templates > \r\nWindows Components > Windows Hello for Business > \r\nUse a hardware security device");

            List<string> listValue = new List<string>();

            listValue.Add("Enabled");
            listValue.Add("Enabled");
            listValue.Add("Enabled");
            listValue.Add("Enabled, Allow user to turn syncing on: Disabled");
            listValue.Add("Disabled");
            listValue.Add("Enabled");
            listValue.Add("Enabled");
            listValue.Add("Disabled");
            listValue.Add("Enabled");
            listValue.Add("600 Seconds");
            listValue.Add("Enabled");
            listValue.Add("Enabled");

            int count = 0;

            foreach (string value in listText)
            {
                Label lblGP = new Label
                {
                    Name = "lblGPDetails",
                    Text = listText[count] + "\r\n-----Set To:-----\r\n" + listValue[count],
                    Font = new Font("Comic Sans MS", 10),
                    AutoSize = true,
                    ForeColor = Color.White,
                    Location = lblLocation
                };

                pnlDetails.Controls.Add(lblGP);

                lblGP.BringToFront();

                lblLocation.Offset(0, lblGP.Height + 30);

                
                CheckBox checkBox = new CheckBox
                {
                    Name = "chkbxValue",
                    Text = "Has Been Set",
                    Font = new Font("Comic Sans MS", 10),
                    AutoSize = true,
                    ForeColor = Color.White,
                    Location = chkbxLocation
                };

                pnlDetails.Controls.Add(checkBox);

                checkBox.BringToFront();

                chkbxLocation.Offset(0, lblGP.Height + 30);
                

                count++;
            }
        }

        private void CloseProcess(string name)
        {
            foreach (Process process in Process.GetProcesses())
            {
                if (process.ProcessName.Contains(name))
                {
                    process.Kill();
                }
            }
        }


        private void openGroupPilocyEditor()
        {
            var proc = Process.Start(@"cmd.exe ", @"/c C:\Windows\System32\gpedit.msc");

            Thread.Sleep(1000);
            
            CloseProcess("cmd");

        }

        private void btnHome_Click(object sender, EventArgs e)
        {
            FormMenu formMenu = new FormMenu();
            formMenu.Show();
            this.Hide();
        }

        private void btnHome_MouseEnter(object sender, EventArgs e)
        {
            btnHome.BackColor = Color.Turquoise;
        }

        private void btnHome_MouseLeave(object sender, EventArgs e)
        {
            btnHome.BackColor = Color.SlateBlue;
        }

        private void btnOpenGP_Click(object sender, EventArgs e)
        {
            openGroupPilocyEditor();
        }

        private void btnOpenGP_MouseEnter(object sender, EventArgs e)
        {
            btnOpenGP.BackColor = Color.Turquoise;

            Label lblDescription = new Label
            {
                Name = "lblDescription",
                Text = "Click to Open the \r\nGroup Policy Editor",
                Font = new Font("Comic Sans MS", 12),
                AutoSize = true,
                ForeColor = Color.White
            };

            pnlDescription.Controls.Add(lblDescription);
            lblDescription.BringToFront();
        }

        private void btnOpenGP_MouseLeave(object sender, EventArgs e)
        {
            btnOpenGP.BackColor = Color.SlateBlue;
            pnlDescription.Controls.Clear();
        }

        private void btnCloseGP_MouseEnter(object sender, EventArgs e)
        {
            btnCloseGP.BackColor = Color.Turquoise;

            Label lblDescription2 = new Label
            {
                Name = "lblDescription2",
                Text = "Click to Close the \r\nGroup Policy Editor",
                Font = new Font("Comic Sans MS", 12),
                AutoSize = true,
                ForeColor = Color.White
            };

            pnlDescription.Controls.Add(lblDescription2);
            lblDescription2.BringToFront();
        }

        private void btnCloseGP_MouseLeave(object sender, EventArgs e)
        {
            btnCloseGP.BackColor = Color.SlateBlue;
            pnlDescription.Controls.Clear();
        }

        private void btnCloseGP_Click(object sender, EventArgs e)
        {
            CloseProcess("mmc");
        }
    }
}
